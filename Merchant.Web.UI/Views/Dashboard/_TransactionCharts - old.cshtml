@model TransactionChartsViewModel

@{
    Layout = null;
}

<div class="row" style="padding:0 15px 10px 15px;">
    <div class="col-md-6">
        <div id="TransactionsPriceChartContainer"></div>
    </div>

    <div class="col-md-6">
        <div id="TransactionsCountChartContainer"></div>
    </div>
</div>

<script type="text/javascript">
    @if (Model.TransactionsPriceChart.ChartData.Any())
    {
        <text>
            $('#TransactionsPriceChartContainer').highcharts({
                exporting: {
                    chartOptions: {
                        plotOptions: {
                            series: {
                                dataLabels: {
                                    enabled: true
                                }
                            }
                        }
                    },
                    fallbackToExportServer: false
                },
                title: { text: 'میانگین مبلغ تراکنش خرید' },
                chart: { type: 'line', marginTop: 120 },
                xAxis: { categories: @Html.Raw(Model.TransactionsPriceChart.ChartCategories.Select(x => x.GetReadableMonthYear()).SerializeToJson()),
                    labels: { rotation: 60 }
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'مبلغ - ریال'
                    },
                    labels: {
                        formatter: function () {
                            return convertToPersianNumbersThreeDigitsSeparated(this.value);
                        }
                    }
                },
                legend: { enabled: false },
                series: [{
                    name: ' ',
                    data: @Html.Raw(Model.TransactionsPriceChart.ChartData.SerializeToJson()),
                    dataLabels: {
                        enabled: true,
                        rotation: 90,
                        crop: false,
                        overflow: 'none',
                        y: -50,
                        inside: false,
                        style: {
                            textOutline: false,
                            backgroundColor: '#ffffff !important'
                        },
                        formatter: function () {
                            return convertToPersianNumbersThreeDigitsSeparated(this.y);
                        }
                    }
                }],
                tooltip: {
                    useHTML: true,
                    crosshairs: true,
                    formatter: function() {
                        return '<b>' +
                            convertToPersianNumbers(this.x) +
                            '</b> <br />' +
                            convertToPersianNumbersThreeDigitsSeparated(this.y);
                    }
                },
                colors: ['#3F51B5']
            });
        </text>
    }

    @if (Model.TransactionsCountChart.ChartData.Any())
    {
        <text>
            $('#TransactionsCountChartContainer').highcharts({
                exporting: {
                    chartOptions: {
                        plotOptions: {
                            series: {
                                dataLabels: {
                                    enabled: true
                                }
                            }
                        }
                    },
                    fallbackToExportServer: false
                },
                title: { text: 'میانگین تعداد تراکنش خرید' },
                chart: { type: 'line', marginTop: 100 },
                xAxis: {
                    categories: @Html.Raw(Model.TransactionsCountChart.ChartCategories.Select(x => x.GetReadableMonthYear()).SerializeToJson()),
                    labels: {
                        rotation: 60,
                        formatter: function () {
                            return convertToPersianNumbers(this.value);
                        }
                    }
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'تعداد'
                    },
                    labels: {
                        formatter: function () {
                            return convertToPersianNumbersThreeDigitsSeparated(this.value);
                        }
                    }
                },
                legend: { enabled: false },
                series: [{
                    name: ' ',
                    data: @Html.Raw(Model.TransactionsCountChart.ChartData.SerializeToJson()),
                    dataLabels: {
                        enabled: true,
                        rotation: 90,
                        crop: false,
                        y: -35,
                        backgroundColor: '#fff',
                        inside: false,
                        useHTML: true,
                        overflow: 'none',
                        style: {
                            textOutline: false
                        },
                        formatter: function () {
                            return convertToPersianNumbersThreeDigitsSeparated(this.y);
                        }
                    }
                }],
                tooltip: {
                    useHTML:true,
                    crosshairs: true,
                    formatter: function () {
                        return '<b>' + convertToPersianNumbers(this.x) + '</b> <br />' + convertToPersianNumbersThreeDigitsSeparated(this.y);
                    }
                },
                colors: ['#E91E63']
            });
        </text>
    }
</script>